# Fly.io application configuration
#
# This file configures the Fly Machine behavior: auto-stop/suspend,
# resource allocation, volume mounts, and HTTP service settings.
# Infrastructure (app, volume, IPs, certs) is managed by OpenTofu
# in infra/deploy/.

app = "crime-map"
primary_region = "iad"

[build]

[http_service]
internal_port = 8080
force_https = true
auto_stop_machines = "suspend"
auto_start_machines = true
min_machines_running = 0

[http_service.concurrency]
type = "requests"
soft_limit = 25
hard_limit = 250

[[vm]]
size = "shared-cpu-2x"
memory = "2gb"

[mounts]
source = "crime_map_data"
destination = "/app/data/generated"

[env]
BIND_ADDR = "0.0.0.0"
PORT = "8080"
RUST_LOG = "info"
